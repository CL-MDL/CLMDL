An Implementation Example of CLMDL
================

This GitHub repository contains R functions to implement the CLMDL algorithm proposed in the paper arXiv:1904.06340. The CLMDL algorithm is designed for conducting multiple change-point estimation in a spatio-temporal process based on a parametric model (e.g. a linear regression based mean function + a Matern covariance function).

The repository consists of two folders, *code* and *output*. The *code* folder contains the R codes and simulated data, and the *output* contains the corresponding RData files generated by the R codes.

### The code folder

The code folder has three R files, `DGP.R`, `Main. R` and `Util_Functions.R`.
1. The `DGP.R` file contains R code to simulate a spatio-temporal process based on the four-parameter autoregressive spatial model (see equation (22) in the manuscript), which is the parametric model employed by CLMDL for the numerical studies in the paper. In particular, on each stationary segment, we have $$y_t-\mu = \phi (y_t-\mu) +\epsilon_t,$$ where $y_t=(y_{t,\textbf{s}}, \textbf{s}\in \mathcal S)\in \mathbb R^S$ collects the observations on $S$ spatial locations at time $t$, and $\mu$ is the mean parameter, $\phi$ is the temporal dependence parameter, and $\epsilon_t=(\varepsilon_{t,\textbf{s}}, \textbf{s}\in \mathcal S)$ is a Gaussian process with exponential covariance function ${\rm Cov}(\varepsilon_{t,\textbf{s}}, \varepsilon_{t,\textbf{s}'}) = \sigma^2\exp(-\left\lVert \textbf{s}-\textbf{s}'\right\lVert_2/\rho)$ with $\sigma^2$ being the variance parameter and $\rho$ being the spatial dependence parameter. This is a special case of the Matern covariance function with $\nu=0.5$. In total, we have four parameters $(\phi, \rho, \sigma^2, \mu)$ on each stationary segment.

   The `DGP.R` file generates the above four-parameter autoregressive spatial model on a regular two-dimensional grid $\mathcal S$ of spatial dimension $S$ and time dimension $T$. It returns a data matrix of size $T \times S$ that stores the spatio-temporal process and a distance matrix of $S\times S$ that stores the distance between the $S$ spatial locations.

2. The `Main.R` file contains the R code to implement the CLMDL algorithm based on the four-parameter autoregressive spatial model. In particular, it requires the input of (a) a data matrix of size $T \times S$ that stores the spatio-temporal process and (b) a distance matrix of $S\times S$ that stores the distance between the $S$ spatial locations. It then conducts multiple change-point estimation in the spatio-temporal process and further constructs confidence interval for each detected change-point (if any). The key tuning parameters are `s.lag` and `t.lag`, which specifies which pairs of observations are used in the construction of the composite log-likelihood. The `s.lag` is the spatial distance parameter $d$ in the manuscript and the `t.lag` is the time lag parameter $k$ in the manuscript.

3. The `Util_Functions.R` contains auxiliary functions for the `DGP.R` and `Main.R` files. Among them, there are two key functions. the `pl()` function computes the 
